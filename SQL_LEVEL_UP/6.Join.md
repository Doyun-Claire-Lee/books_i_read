# 결합
## 기능적 관점으로 구분하는 결합의 종류

> 생성되는 결과의 형태에 따라 분류됨. 서로 배타적인 분류이므로 '내부 결합이면서 외부 결합이다'와 같은 조합은 없다.
> - 크로스 결합
> - 내부 결합
> - 외부 결합

> 결합 조건으로 등호(=)를 사용하는지, 부등호를 사용하는지에 따라 분류
> - 등가 결합
> - 비등가 결합

> 내부 결합이면서 등가 결합
> - 자연 결합

1. 크로스 결합 - 모든 결합의 모체
- 실무에서 사용하는 경우가 없음(크로스 결합의 결과가 필요한 경우가 없고, 비용이 매우 많이 드는 연산이기 때문)

2. 내부 결합 - 왜 '내부' 일까?
- 가장 많이 사용되는 조합 중 하나
- 내부 결합의 결과는 모두 크록스 결합의 일부(부분 집합)이기 때문에, '내부' 라는 용어를 사용
- 기본 키를 사용하여 내부 결합 결과와 똑같은 스칼라 서브쿼리를 구현할 수 있다.
- 내부 결합을 사용할 수 있는 경우 내부 결합을 사용하는 게 비용 면에서 유리하다.

3. 외부 결합 - 왜 '외부' 일까?
- 왼쪽 외부 결합, 오른쪽 외부 결합, 완전 외부 결합
- 마스터가 되는 테이블을 왼쪽에 적으면 왼쪽 외부 결합, 오른쪽에 적으면 오른쪽 외부 결합

4. 외부 결합과 내부 결합의 차이
- 외부 결합의 결과가 크로스 결합 결과의 부분 접합이 아닌 이유는, 외부 결합이 마스터 테이블의 정보를 모두 보존하고자 NULL을 생성하기 때문
- 크로스 결합과 내부 결합은 NULL을 생성하지 않음

5. 자기 결합
- 말 그대로 자기 자신과 결합하는 연산
- 생성되는 결과를 기준으로 분류하는 것이 아니라 연산의 대상으로 무엇을 사용하는지에 따른 분류
- 자기 결합을 수행하는 경우 일반적으로 같은 테이블에 별칭을 붙여 마치 다른 테이블인 것처럼 다룸.

# 결합 알고리즘과 성능

> 옵티마이저가 선택 가능한 알고리즘은 크게 다음과 같다.
> - Nested Loops : 가장 빈번하게 볼 수 있고, 각종 결합 알고리즘의 기본이 되는 알고리즘
> - Hash
> - Sort Merge

- 옵티마이저가 어떤 알고리즘을 선택할지의 여부는 데이터 크기 또는 결합 키의 분산 요인에 의존한다.

1. Nested Loop
- 이름 그대로 중첩 반복을 사용하는 알고리즘
- 결합은 한번에 두 개의 테이블만 결합하므로 본질적으로 이중 반복과 같은 의미
- 결합 대상 테이블(구동 테이블, 외부 테이블)에서 레코드를 하나씩 반복해가며 스캔 후, 구동 테이블의 레코드 하나마다 다른 테이블(내부 테이블)이 레코드를 하나씩 스캔해서 결합 조건에 맞으면 리턴한다.
- 구동 테이블이 무엇이든 간에 접근하는 레코드 수는 변하지 않지만, 실제로 구동 테이블의 선택은 성능에서 굉장히 중요한 의미를 가짐.
- 구체적으로는, 구동 테이블이 작을수록 성능이 좋아짐.(내부 테이블의 결합 키 필드에 인덱스가 존재하는 경우)
